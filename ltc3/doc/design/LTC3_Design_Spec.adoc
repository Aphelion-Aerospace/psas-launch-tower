Portland State Aerospace Society Launch Tower Computer III Design Specification
===============================================================================
PSAS Avionics Team <psas-avionics@lists.psas.pdx.edu>
v0.1, 27 January 2015: DRAFT

:imagesdir: ./images


Summary
-------

The launch tower computer (LTC) is an integral component in the
Portland State Aerospace Society (PSAS) launch vehicle complex.  It is
responsible for providing shore power to the rocket while it remains
on the launch pad; manages the ignition safety interlock system; and
ignites the rocket motor at launch time.

The existing launch tower computer, the second major design
since the founding of the http://psas.pdx.edu/[Portland State
Aerospace Society] (PSAS), is due for an overhaul.  It's only been two
years since LTC II was put into service, but there have been rapid
advances in available off-the-shelf technology, and our understanding
of what we need (and don't want) in an LTC has continued to evolve.

This document is the source of authority for all questions related to
the design and implementation of the LTC III.  If the design of the
LTC doesn't conform to this document, either fix the design, or update
the document.



Definitions
-----------

Computer::
  The single-board computer that comprises the core of the LTC.

Launch Tower Computer (LTC)::
  The entire system, including the enclosure, the single-board
  computer, the peripherals, etc.

Power Source::
  All the ways the LTC can get the juice it needs.  External power
  from the outside world that the LTC sinks for various internal
  purposes.

Power Supply::
  The power rails the LTC provides to its various peripherals.
  Internal LTC circuits that sink external power, convert and
  condition it, and supply it to other (internal and external)
  subsystems.



LTC II Review
-------------


The Good
~~~~~~~~
* Smaller and less heavy than LTC I

[[image-ltc_i]]
.The guts of LTC I
image::LTC_I.jpeg[]

* Safety interlocks!

* Solar charging.

* LiPo ignition battery.

[[image-ltc_ii_lipo_ignition_battery_pack]]
.LTC III ignition board and LiPo battery pack.
image::LTC_II_LiPo_Ignition_Battery_Pack.jpeg[]


The Not-So-Good
~~~~~~~~~~~~~~~

* While smaller and lighter than LTV v1, still big and bulky and a
  pain to carry around.

* Complicated, heavily mod-wired, and difficult to trace wires make it
  all hard to debug.

[[image-ltc_ii]]
.The guts of LTC II
image::LTC_II.jpeg[Photo of the interior of LTC II]

* The shore power DC-DC converter integrated with the power board was
  sorely inadequate.

[[image-ltc_ii_power_board]]
.LTC II power board.
image::LTC_II_Power_Board.jpeg[Photo of LTC II's power supply board.]

* Lead-acid car batteries (LTC II's main power source) are bulky and
  heavy.

* http://www.phidgets.com/[Phidgets].  Expensive (relatively), fiddly,
  and require their own interface board.  Their software stack is
  thick and troublesome to install.

[[image-ltc_ii_phidgets]]
.LTC II Phidgets interface board.
image::LTC_II_Phidget_Interface_Board.jpeg[Photo of LTC II's Phidgets interface board.]

* The door covering the side bulkhead (power and arm switches) can't
  be closed when the shorting bar is in place.  The bar has to be
  stored elsewhere when the LTC not in use.

[[image-ltc_ii_bulkhead_door]]
.LTC II bulkhead access door.
image::LTC_II_Bulkhead_Door.jpeg[Photo of LTC II's bulkhead access door.]

* The PowerPole connectors on the bottom bulkhead are too deeply
  recessed, located too close together, and poorly labeled.

[[image-ltc_ii_power_connectors]]
.LTC II external power connectors.
image::LTC_II_Power_Connectors.jpeg[Photo of LTC II's power connectors.]



Goals
-----

* Simplify!  LTC II has too many circuit boards, too many wires, too
  many everything.  It's difficult to service most of LTC II's
  components without major disassembly.  Peripherals (sensors, relays,
  etc.) should be contained on a single custom PCB.

* Make it smaller.  Reduce the size of the boards, batteries, and
  potentially even the enclosure.

* Optional: Replace LTC II's plastic enclosure with a metal enclosure, for
  durability and RFI protection, without sacrificing light weight.

* Improve the enclosure-to-tower mounting apparatus;
  make it fast and easy to mount (and dismount) the enclosure to the
  tower (https://en.wikipedia.org/wiki/DIN_rail[DIN rail] mounting (or
  something similar).

* Strive for field-replaceable units (FRU) whenever possible.  FRUs
  can be swapped out with basic tools, in a minimum amount of time.

* Make it user-friendly (i.e., fool-proof).  Any member of PSAS
  should be able to achieve a high-level understanding of the LTC in a
  short amount of time.  Any member should be able to operate, and if
  necessary service, the LTC given suitable documentation.

* Conduct a thermal analysis.  Do we need an active cooling system to
  deal with the heat of a desert launch site?



Requirements
------------

Power Sources
~~~~~~~~~~~~~
Where the juice comes from.

* (10, 14.4, 16.8) VDC from main batteries
** Internal; permanent.
** Sufficient capacity to source internal and external loads (~4 AH)

* (10, 12, 17) VDC from photovoltaic ("PV") panels
** External.

* max 24 VDC lab power connection (while not in the field)
** External; separate from PV input.
** ThinkPad switching "pregnant snake" power supply: 19 V, several A


Power Loads
~~~~~~~~~~~
Who the juice goes to.

* Several external expansion power connectors
** Switchable by the computer
* Computer peripherals (5V)
** Ignition board


Power Supplies
~~~~~~~~~~~~~~
Power conditioning that the LTC provides.

* 5 VDC for computer power, etc.
** TODO: power/current requirement... ~10 W

* 12-15 VDC for ignition battery charger
** Assuming a buck/boost battery charger, else > 14.7 V
** NOT integral to LTC. Separate system.
** COTS, not a custom design!

* 19 VDC @ 4 A for rocket shore power
** LTC2 was browning out @ 2 A; replacement converter is 4 A


Relays
~~~~~~

* Internal: ignition

* External: expansion peripherals
** Power connectors
** Switch across input pair (no power)
*** Opto-isolated


Networking
~~~~~~~~~~

* WiFi connection to Launch Control.

* Internal Ethernet switch
** LTC computer; rocket; external (debug, expansion peripherals)
** Switch or dumb hub? Is there any debugging value to being able to see all the internal traffic via a hub?


Sensors
~~~~~~~

* Voltage sensors for each power rail.
** 5 VDC; 19 VDC; main battery; ignition battery; PV; lab

* Temperature sensors
** Board; main battery pack; enclosure interior

* Ignition fuse state

* Current consumption
** PV; battery; rocket

* Rocket-ready status

* Umbilical connection state


User Interface
~~~~~~~~~~~~~~

* Main power switch

* Ignition arming switch.

* Ignition shorting bar.

* Ignition fuse.

* Front panel voltmeters for each power rail.
** Activated by momentary push-button.
** Independent of SBC.  Useful for debug.
** IDEA: an entire LCD display driven by the SBC.  If the SBC can't come
   up, independent meters aren't worth much.
*** Grayscale transflective display
*** On panel; acrylic shield; sun shade.
** IDEA: keep the panel DMM, unconnected, for debug use
** IDEA: scrap the panel DMM, include a real DMM for debug (internally mounted)

[[image-panel_dmm]]
image:panel_dmm-30303.jpeg[Photo of an panel-mount digital volt- and ammeter.]

* Front panel LEDs indicating the status of each relay, and the
  rocket-ready status.
** relays; triggers
** must be daylight-readable (shrouded?)

* Label all the things!  Components, connectors, switches, oh my!


External Connections
~~~~~~~~~~~~~~~~~~~~

* Power In
** solar panels
** lab (AKA "shore shore")

* Rocket umbilical
** Ethernet, shore power, rocket-ready

* Away box

* WiFi coax to external antenna

* Expansion support
** Power connectors, connected directly to main battery rail.

** Several Ethernet connectors that provide external access to the
   LTC's internal switch, for debug and expansion purposes.

** Several expansion trigger switches, for computer control of cameras,
   etc.  Switches short two external inputs together.  Nathan proposes
   1/8" phono connectors for these.

** Expansion Ethernet and power connectors can be paired up for use
   with passive PoE injectors, providing single-cable power and network
   support for off-board devices (e.g., weather station).

* Distinct, keyed connectors for each external connection.  There
  should be no way to accidentally connect a data cable to a power
  outlet; or to reverse the polarity of a connector.



Design
------

TODO: More words, please.

* BeagleBone Black SBC

* BBB flipped upside down and mated to peripheral board via pin
  headers.  A kilt, rather than a cape!


Power Sources
~~~~~~~~~~~~~

* 12V nominal input from an external wall-mount power supply

* 17V (open circuit) PV power input

** MPPT?

* Internal LiPo power pack (10,14.4,16.8)V @ ??? AHr

** Battery charger from PV? Shore power?


Power Supplies
~~~~~~~~~~~~~~


Ignition Subsystem
~~~~~~~~~~~~~~~~~~
* The ignition signal is controlled by two relays in series
** One on the ignition board controlled by RocketReady (from the FC)
** One on the relay board controlled by the LTC

Networking
~~~~~~~~~~

* Internal Ethernet switch.


Wish List
---------

* Improved enclosure.
** Smaller; metal.
** IDEA: narrow (tower width); shoebox-ish size
** Metal more robust; RF proof.  May soak up more solar heat.
** IDEA: Pelican case. Handles!
** Lay-flat-able!
*** At least one side free of protuberances.

* Improved enclosure-to-tower mounting apparatus

* Andrew strongly suggests a single-board LTC3.
** Lots of Maxim Test Points along traces between sub-systems.

* Multiple backup LTCs.

* Prototyping area
** 0.1" hole grid; off-board connectors


References
----------

http://kilobaser.com/blog/2014-07-15-beaglebone-black-gpios["BeagleBone
Black GPIOs"], KiloBaser.
